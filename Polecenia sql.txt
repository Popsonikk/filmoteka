

2. Lista klientów sklepu posegregowana malejąco względem nazwiska:
	SELECT first_name, last_name, email 
	FROM customer 
	ORDER BY last_name DESC ,first_name DESC;

3. Lista cen filmów dostępnych w sklepie:
	SELECT DISTINCT amount 
	FROM payment 
	ORDER BY amount DESC;

4. Lokalizacje, z których klienci dokonali zakupu:
	SELECT DISTINCT district 
	FROM address;

5. Liczba filmów w bazie:
	SELECT COUNT(*) 
	FROM film;

6. Lista transakcji posegregowana po dacie wykonania:
	SELECT * 
	FROM rental 
	ORDER BY rental_date DESC;

7. Sprawdzenie wszystkich transakcji danego klienta:
	SELECT * 
	FROM payment 
	WHERE customer_id=X;

8. Lista wypożyczeń, które nie zostały zwrócone:
	SELECT * 
	FROM rental 
	WHERE return_date IS NULL;

9. Lista płatności o konkretnej wartości:
	SELECT * 
	FROM payment 
	WHERE amount=X;

10. Lista płatności konkretnych klientów, konkretnych kwot:
	SELECT * 
	FROM payment 
	WHERE customer_id IN (X) AND amount BETWEEN X AND X;

11. Lista płatności między konkretnymi datami, konkretne kwoty:
	SELECT * 
	FROM payment 
	WHERE payment_date BETWEEN 'DDDD-MM-DD HH:MM' AND 'DDDD-MM-DD HH:MM' AND amount BETWEEN X AND X;

12. Liczba i suma transakcji poszczególnych pracowników sklepu:
	SELECT COUNT(*), SUM(amount) AS total, staff_id AS Staff 
	FROM payment 
	WHERE amount!=0 
	GROUP BY Staff;

13. Sprzedaż z rozbiciem na pracownika oraz dzień:
	SELECT DATE(payment_date) AS date, SUM(amount) AS total, staff_id AS Staff 
	FROM payment 
	GROUP BY Staff,DATE(payment_date) 
	ORDER BY total DESC

14. Średnia wartość transakcji klientów z danych dni przy więcej niż jednej transakcji
	SELECT ROUND(AVG(amount),2) AS average, customer_id AS customer, DATE(payment_date) AS date ,count(*) AS trans 
	FROM payment  
	WHERE DATE(payment_date) BETWEEN '2020-04-28' AND '2020-05-01' 
	GROUP BY customer, date 
	HAVING count(*)>1 
	ORDER BY average DESC;

15. Stosunek ceny filmów do ceny wypożyczeń filmu
	SELECT title, rental_rate, replacement_cost, ROUND(rental_rate/replacement_cost*100,2) AS relation 
	FROM film 
	ORDER BY relation ASC;

16. Podział filmów na ustalone w kursie kategorie:
	SELECT title, 
	CASE	
		WHEN rating IN ('PG','PG-13') OR length>210 THEN 'tier 1'
		WHEN description LIKE '%Drama%' AND length >90 THEN 'tier 2'
		WHEN description LIKE '%Drama%' AND length <90 THEN 'tier 3'
		WHEN rental_rate<1 THEN 'tier 4'
		ELSE 'tier 5'
	END
	FROM film;
17. Liczba filmów w poszczególnej kategorii
	SELECT rating, COUNT(rating) 
	FROM film 
	GROUP BY rating;

18. Wyczyszczenie listy zwrotów z wartości null
	SELECT rental_date, COALESCE(CAST(return_date AS VARCHAR),'Not returned yet') 
	from rental 
	order by rental_date DESC;

19 Lista łącznej płatności klientów po imieniu I nazwisku:
	SELECT c.first_name || ' '|| c.last_name AS client, SUM(p.amount) AS sum
	FROM payment p INNER JOIN customer c  ON p.customer_id=c.customer_id 
	GROUP BY client ORDER BY sum DESC